"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Sidebar = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const TrendingList_1 = require("./TrendingList");
const Sidebar = ({ collapsed, onToggleCollapse, trendingThemes, loading = false, error = null, onRetry, onThemeClick, useRealData, onUseRealDataChange, lastUpdated, className = '', onToggleFavorite, isFavorite }) => {
    const [currentTime, setCurrentTime] = (0, react_1.useState)('');
    // 僅在客戶端更新時間，避免 SSR hydration 問題
    (0, react_1.useEffect)(() => {
        const updateTime = () => setCurrentTime(new Date().toLocaleString('zh-TW'));
        updateTime();
        const intervalId = setInterval(updateTime, 1000);
        return () => clearInterval(intervalId);
    }, []);
    const handleThemeClick = (0, react_1.useCallback)((theme) => {
        onThemeClick(theme);
    }, [onThemeClick]);
    const formatLastUpdated = (date) => {
        if (!date)
            return '尚未更新';
        const now = new Date();
        const diff = now.getTime() - date.getTime();
        const minutes = Math.floor(diff / (1000 * 60));
        if (minutes < 1)
            return '剛剛';
        if (minutes < 60)
            return `${minutes} 分鐘前`;
        const hours = Math.floor(minutes / 60);
        if (hours < 24)
            return `${hours} 小時前`;
        return date.toLocaleDateString('zh-TW');
    };
    return ((0, jsx_runtime_1.jsxs)("div", { className: `flex flex-col h-full bg-white border-r border-gray-200 ${className}`, children: [(0, jsx_runtime_1.jsxs)("div", { className: "p-6 border-b border-gray-200 flex items-center justify-between bg-gradient-to-r from-blue-50 to-indigo-50", children: [!collapsed && ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-3", children: [(0, jsx_runtime_1.jsx)("div", { className: "w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center", children: (0, jsx_runtime_1.jsx)("svg", { className: "w-6 h-6 text-white", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: (0, jsx_runtime_1.jsx)("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" }) }) }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("h2", { className: "text-xl font-bold text-gray-900", children: "\u6982\u5FF5\u80A1\u7BE9\u9078\u5668" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600", children: "\u71B1\u9580\u6295\u8CC7\u4E3B\u984C" })] })] })), (0, jsx_runtime_1.jsx)("button", { onClick: onToggleCollapse, className: "p-3 rounded-xl hover:bg-white/80 transition-all duration-200 hover:shadow-md", "aria-label": collapsed ? '展開側邊欄' : '收合側邊欄', children: (0, jsx_runtime_1.jsx)("svg", { className: "w-5 h-5 text-gray-600", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: (0, jsx_runtime_1.jsx)("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M4 6h16M4 12h16M4 18h16" }) }) })] }), !collapsed && ((0, jsx_runtime_1.jsxs)("div", { className: "p-6 border-b border-gray-200 bg-gray-50", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between mb-4", children: [(0, jsx_runtime_1.jsx)("h3", { className: "text-sm font-semibold text-gray-700", children: "\u8CC7\u6599\u4F86\u6E90" }), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2", children: [(0, jsx_runtime_1.jsx)("div", { className: "w-2 h-2 bg-green-500 rounded-full animate-pulse" }), (0, jsx_runtime_1.jsx)("span", { className: "text-xs text-gray-500", children: "\u5373\u6642\u66F4\u65B0" })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-3", children: [(0, jsx_runtime_1.jsxs)("label", { className: "flex items-center justify-between p-4 bg-white rounded-lg border border-gray-200 hover:border-blue-300 transition-colors cursor-pointer", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-3", children: [(0, jsx_runtime_1.jsxs)("div", { className: "relative", children: [(0, jsx_runtime_1.jsx)("input", { type: "checkbox", checked: useRealData, onChange: (e) => onUseRealDataChange(e.target.checked), className: "sr-only" }), (0, jsx_runtime_1.jsx)("div", { className: `w-12 h-6 rounded-full transition-colors ${useRealData ? 'bg-green-500' : 'bg-gray-300'}`, children: (0, jsx_runtime_1.jsx)("div", { className: `w-4 h-4 bg-white rounded-full shadow-md transform transition-transform ${useRealData ? 'translate-x-6' : 'translate-x-1'}`, style: { marginTop: '4px' } }) })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("div", { className: "font-medium text-gray-900", children: "\u771F\u5BE6\u53F0\u80A1\u8CC7\u6599" }), (0, jsx_runtime_1.jsx)("div", { className: "text-xs text-gray-500", children: "\u53F0\u7063\u8B49\u5238\u4EA4\u6613\u6240" })] })] }), useRealData && ((0, jsx_runtime_1.jsxs)("span", { className: "inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800", children: [(0, jsx_runtime_1.jsx)("svg", { className: "w-3 h-3 mr-1", fill: "currentColor", viewBox: "0 0 20 20", children: (0, jsx_runtime_1.jsx)("path", { fillRule: "evenodd", d: "M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z", clipRule: "evenodd" }) }), "\u5DF2\u555F\u7528"] }))] }), useRealData && ((0, jsx_runtime_1.jsxs)("div", { className: "p-3 bg-green-50 border border-green-200 rounded-lg", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2 text-sm text-green-700", children: [(0, jsx_runtime_1.jsx)("svg", { className: "w-4 h-4", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: (0, jsx_runtime_1.jsx)("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" }) }), (0, jsx_runtime_1.jsx)("span", { className: "font-medium", children: "\u8CC7\u6599\u4F86\u6E90" })] }), (0, jsx_runtime_1.jsx)("div", { className: "mt-1 text-xs text-green-600", children: "\u53F0\u7063\u8B49\u5238\u4EA4\u6613\u6240 + Yahoo Finance" })] }))] }), (0, jsx_runtime_1.jsxs)("div", { className: "mt-4 p-3 bg-white rounded-lg border border-gray-200", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between text-xs text-gray-500", children: [(0, jsx_runtime_1.jsx)("span", { children: "\u6700\u5F8C\u66F4\u65B0" }), (0, jsx_runtime_1.jsx)("span", { className: "font-medium", children: formatLastUpdated(lastUpdated || null) })] }), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between text-xs text-gray-500 mt-1", children: [(0, jsx_runtime_1.jsx)("span", { children: "\u7576\u524D\u6642\u9593" }), (0, jsx_runtime_1.jsx)("span", { className: "font-medium", children: currentTime || '載入中...' })] })] })] })), (0, jsx_runtime_1.jsx)("div", { className: "flex-1 overflow-y-auto", children: !collapsed ? ((0, jsx_runtime_1.jsx)(TrendingList_1.TrendingList, { themes: trendingThemes, onThemeClick: handleThemeClick, loading: loading, error: error, onRetry: onRetry, onToggleFavorite: onToggleFavorite, isFavorite: isFavorite })) : ((0, jsx_runtime_1.jsxs)("div", { className: "p-4", children: [(0, jsx_runtime_1.jsx)("div", { className: "space-y-3", children: trendingThemes.slice(0, 5).map((theme, index) => ((0, jsx_runtime_1.jsx)("div", { onClick: () => handleThemeClick(theme), className: "p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-all duration-200 hover:shadow-sm group", title: theme.theme, children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex-1 min-w-0", children: [(0, jsx_runtime_1.jsx)("div", { className: "text-sm font-medium text-gray-900 truncate group-hover:text-blue-600 transition-colors", children: theme.theme }), (0, jsx_runtime_1.jsxs)("div", { className: "text-xs text-gray-500 truncate", children: [theme.stocks.length, " \u6A94\u80A1\u7968"] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "flex-shrink-0 ml-2", children: [(0, jsx_runtime_1.jsx)("div", { className: "text-sm font-bold text-red-500", children: theme.heatScore }), (0, jsx_runtime_1.jsx)("div", { className: "w-8 h-1 bg-gray-200 rounded-full overflow-hidden", children: (0, jsx_runtime_1.jsx)("div", { className: "h-full bg-gradient-to-r from-red-500 to-orange-500 rounded-full", style: { width: `${theme.heatScore}%` } }) })] })] }) }, theme.id))) }), trendingThemes.length > 5 && ((0, jsx_runtime_1.jsx)("div", { className: "mt-4 text-center", children: (0, jsx_runtime_1.jsxs)("span", { className: "text-xs text-gray-500 bg-gray-100 px-3 py-1 rounded-full", children: ["\u9084\u6709 ", trendingThemes.length - 5, " \u500B\u4E3B\u984C"] }) }))] })) }), !collapsed && ((0, jsx_runtime_1.jsx)("div", { className: "p-4 border-t border-gray-200 bg-gray-50", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between text-xs text-gray-500", children: [(0, jsx_runtime_1.jsx)("span", { children: "\u7CFB\u7D71\u72C0\u614B" }), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2", children: [(0, jsx_runtime_1.jsx)("div", { className: "w-2 h-2 bg-green-500 rounded-full" }), (0, jsx_runtime_1.jsx)("span", { children: "\u6B63\u5E38\u904B\u884C" })] })] }) }))] }));
};
exports.Sidebar = Sidebar;
